---
title: "Subscription costs to scientific publishers in Finland 2010-2015"
author: Leo Lahti
date: "`r Sys.Date()`"
output: 
  md_document:
    variant: markdown_github
---


```{r foi-init, message=FALSE, echo=FALSE}
library(dplyr)
library(tidyr)
library(reshape2)
library(ggplot2)
theme_set(theme_bw(20))
# License fee data URL
f <- "~/data/Tietopyynto/20160607\ Kustantajahintatiedot_koottu_v0.99.csv"
# Read the data
df <- read.csv(f, fileEncoding = "latin1")
# Rename
df = rename(df, Publisher = Kustantaja.Välittäjä)
df = rename(df, Organization = Organisaation.nimi)
df = rename(df, Organization.type = Organisaation.tyyppi)
df = rename(df, Category = Aineistotyyppi)
df = rename(df, Material = Aineisto)
df = rename(df, Type = Hankintatapa)
df = rename(df, Year = Vuosi)
df = rename(df, Price = Hinta)

# Translations
df$Organization.type = gsub("Yliopisto", "University", df$Organization.type)
df$Organization.type = gsub("Ammattikorkeakoulu", "Polytechnic", df$Organization.type)
df$Organization.type = gsub("Tutkimuslaitos", "Research Institute", df$Organization.type)
df$Organization.type = gsub("Muu", "Other", df$Organization.type)
df$Organization.type = factor(df$Organization.type)

df$Category = gsub("Kokotekstiaineisto", "Full text", df$Category)
df$Category = gsub("Viitetietokanta", "Reference database", df$Category)
df$Category = gsub("Hakuteos", "Reference book", df$Category)
df$Category = gsub("Muu elektroninen palvelu", "Other electronic service", df$Category)
df$Category = gsub("E-kirjapaketti", "E-books", df$Category)
df$Category = gsub("Muu", "Other", df$Category)
df$Category = gsub("Sanakirja", "Dictionary", df$Category)
df$Category = factor(df$Category)

#df$Organization = gsub("yliopisto", "University", df$Organization)
#df$Organization = gsub("ammattikorkeakoulu", "Polytechnic", df$Organization)
```


Scientific journal subscription costs in Finland 2010-2015
===========


## Background

Following [Tim Gowers successful FOI request on the subscription costs
for scientific journals in
UK](http://gowers.wordpress.com/2014/04/24/elsevier-journals-some-facts/),
we made a similar request in Finland together with the [Open Knowledge
Finland association and other Open Science
advocates](https://www.facebook.com/groups/241398182642057/permalink/411482855633588). After
the Finnish universities [turned down my FOI request in summer
2014](https://github.com/okffi-science/2014-tietopyynto-lisenssimaksut),
we appealed in court, which decided the case positive for us in August
2015.

The Finnish Ministry of Education [Open Science
Initiative](http://openscience.fi) then organized the [data release]()
as summarized [elsewhere](). With this, Finland is becoming one of the
first countries (after US and UK) where the subscription fees have
been released at the level of individual publishers. For a summary on
other countries, see Stuart Lawson's [recent
post](http://stuartlawson.org/2016/06/publicly-available-data-on-international-journal-subscription-costs).
Here, we present a preliminary analysis of the data, including
[reproducible source
code](https://github.com/antagomir/temp/blob/master/20160610/foi.Rmd). I
have here translated key terms from the Finnish data release to better
serve the international audience.


## Overall subscription costs 2010-2015

```{r foi-tables, message=FALSE, echo=FALSE, fig.show="hold", out.width="430px", fig.width = 7, fig.height = 5}
dfs = df %>% group_by(Category) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
dfs$Category = factor(dfs$Category, levels = rev(as.character(dfs$Category)))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
names(dfs) = c("Category", "Total (MEUR)", "Percent (%)")
write.csv(dfs, file = "table/cost_by_category.csv", quote = F, row.names = F)

dfs <- df %>% group_by(Year, Organization) %>% summarise(Costs = sum(Price, na.rm = TRUE)/1e6) %>% arrange(Year) %>% spread(Year, Costs)
dfs[is.na(dfs)] = 0
dfs$Organization = as.character(dfs$Organization)
dfs$Total = rowSums(dfs[, as.character(2010:2015)], na.rm = TRUE)
dfs$Percentage = 100 * dfs$Total/sum(dfs$Total)
dfs = dfs %>% arrange(desc(Percentage))
dfs = rbind(c("Total", colSums(dfs[, -1])), dfs)
names(dfs) = c("Organization (costs in MEUR)", as.character(2010:2015), "Total", "%")
for (i in 2:ncol(dfs)) {dfs[,i] = round(as.numeric(unlist(dfs[,i])),2)}
write.csv(dfs, file = "table/cost_by_organization_year.csv", quote = F, row.names = F)


dfs <- df %>% group_by(Year, Publisher) %>% summarise(Costs = sum(Price, na.rm = TRUE)/1e6) %>% arrange(Year) %>% spread(Year, Costs)
dfs[is.na(dfs)] = 0
dfs$Publisher = as.character(dfs$Publisher)
dfs$Total = rowSums(dfs[, as.character(2010:2015)], na.rm = TRUE)
dfs$Percentage = 100 * dfs$Total/sum(dfs$Total)
dfs = dfs %>% arrange(desc(Percentage))
dfs = rbind(c("Total", colSums(dfs[, -1])), dfs)
dfs$Publisher = substr(dfs$Publisher, 1, 80)
names(dfs) = c("Publisher (costs in MEUR)", as.character(2010:2015), "Total", "%")
for (i in 2:ncol(dfs)) {dfs[,i] = round(as.numeric(unlist(dfs[,i])),2)}
write.csv(dfs, file = "table/cost_by_publisher_year.csv", quote = F, row.names = F)


dfs = df %>% group_by(Type) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
dfs$Type = factor(dfs$Type, levels = rev(as.character(dfs$Type)))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
names(dfs) = c("Type", "Total (MEUR)", "Percent (%)")
write.csv(dfs, file = "table/cost_by_type.csv", quote = F, row.names = F)
```

Based on the data collected by the Ministry of Education, Finland paid
`r round(sum(df$Price)/1e6, 1)` million EUR subscription and other
fees on scientific publishing during 2010-2015. It seems to me that
open access publishing fees are not included, as I could not find some
major open access players (PLoS, BMC) from the list.

Information is also available on the [agreement
type](table/cost_by_type.csv), organization type, and [subscription
category](table/cost_by_category.csv).


```{r foi-totalcosts, message=FALSE, echo=FALSE, fig.show="hold", out.width="430px", fig.width = 7, fig.height = 5}
dfs = df %>% group_by(Category) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
dfs$Category = factor(dfs$Category, levels = rev(as.character(dfs$Category)))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
# Only consider the high-level categories
dfss = dfs[-grep(";", dfs$Category),]
p <- ggplot(dfss, aes(x = Category, y = Costs)) + geom_bar(stat = "identity", fill = "lightgray", color = "black") + ggtitle("Costs by category") + coord_flip() + xlab("") + ylab("Total Costs (MEUR)") + geom_text(aes(x=Category, y=35, label=paste(Percentage, "%", sep = ""), hjust=ifelse(sign(Percentage)>0, 0, 0)), position = position_dodge(width=1), size = 7)
print(p)
```


### Costs by publisher

Overall, the Finnish data covers `r length(unique(df$Publisher))` publishers ([see annual costs by publisher](table/cost_by_publisher_year.csv)). The figure shows the absolute and relative fees paid to the top publishers during 2010-2015.

Interestingly, over one third of the total costs go to Elsevier, which is often [criticized](https://gowers.wordpress.com/2014/04/24/elsevier-journals-some-facts/) for its huge [profit margins](http://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0127502). Unfortunately the costs are given by bundle, so we cannot estimate prices per individual article between publishers from this data. A rough look at the number of subscriptions indicates that Elsevier has third most subscriptions (`r round(100 * mean(df$Publisher == "Elsevier"), 1)`%) but this is not very informative as the bundle sizes may vary greatly. 

```{r foi-totalcosts2b, message=FALSE, echo=FALSE, fig.show="hold", out.width="430px", fig.width = 10, fig.height = 9}
dfs = df %>% group_by(Publisher) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
dfs$Publisher = factor(dfs$Publisher, levels = rev(as.character(dfs$Publisher)))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
p <- ggplot(dfs[1:20,], aes(x = Publisher, y = Costs)) + geom_bar(stat = "identity", fill = "lightgray", color = "black") + ggtitle("Costs by publisher") + coord_flip() + xlab("") + ylab("Total Costs (MEUR)") + geom_text(aes(x=Publisher, y=32, label=paste(Percentage, "%", sep = ""), hjust=ifelse(sign(Percentage)>0, 0, 0)), position = position_dodge(width=1), size = 7)
print(p)

dfs = df %>% group_by(Publisher) %>% summarise(n = n()) %>% arrange(desc(n))
dfs$Publisher = factor(dfs$Publisher, levels = rev(as.character(dfs$Publisher)))
dfs$Percentage = round(100 * dfs$n/sum(dfs$n), 1)
p <- ggplot(dfs[1:20,], aes(x = Publisher, y = n)) + geom_bar(stat = "identity", fill = "lightgray", color = "black") + ggtitle("Subscriptions by publisher") + coord_flip() + xlab("") + ylab("Subscriptions (n)") + geom_text(aes(x=Publisher, y=32, label=paste(Percentage, "%", sep = ""), hjust=ifelse(sign(Percentage)>0, 0, 0)), position = position_dodge(width=1), size = 7)
print(p)


dfs = df %>% group_by(Type) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
dfs$Type = factor(dfs$Type, levels = rev(as.character(dfs$Type)))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
```


```{r foi-costperyear, message=FALSE, eval=TRUE, echo=FALSE, fig.show="hold", out.width="200px"}
dfs = df %>% group_by(Publisher) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
```

The total costs paid to scientific publishers by Finland have increased roughly 10% per year in 2010-2015 (annual increase is indicated in the left figure). The top-10 publishers (out of `r length(unique(df$Publisher))`) correspond to `r round(100 * sum(dfs[["Costs"]][1:10])/sum(dfs[["Costs"]]))`% of the overall costs (right figure). The full [annual costs by publisher](table/cost_by_publisher_year.csv) are in a separate table.

```{r foi-costbytime, message=FALSE, echo=FALSE, fig.width=15, fig.height=6, out.width="850px"}
# Price, Year : all publishers
# Growth percentage compared to previous year is shown
dfs = df %>% group_by(Year) %>% summarise(Costs = sum(Price)/1e6) 
p1 <- ggplot(dfs, aes(x = Year, y = Costs)) +
       geom_bar(stat = "identity", fill = "lightgray", color = "black") + ggtitle("Total costs (Finland)") +
       geom_text(data = dfs[-1,], aes(x = Year, y = 1.5,
     label = paste(round(100 * diff(dfs$Costs)/dfs$Costs[-length(dfs$Costs)], 1), "%", sep = "")   ),
     	   size = 6) +
       scale_x_continuous(breaks = 2010:2015, labels = c(2010:2015)) + 
       ylab("Costs (MEUR)")
#print(p1)

dfss = df %>% group_by(Publisher) %>% summarise(Costs = sum(Price, na.rm = TRUE)) %>% arrange(desc(Costs))
top.publishers <- as.character(dfss$Publisher[1:10])
dfs2 <- dplyr::filter(df, Publisher %in% top.publishers) %>% group_by(Year, Publisher) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(Year)
dfs2$Publisher <- factor(dfs2$Publisher, levels = top.publishers)
p2 <- ggplot(dfs2, aes(x = Year, y = Costs, color = Publisher)) +
       geom_point() +
       geom_line() +       
       ggtitle("Cost development by publisher") +
       ylab("Costs (MEUR)") 
#print(p2)

library(gridExtra)
grid.arrange(p1, p2, widths=c(4, 9))
```




### Costs by organization

```{r foi-totalcosts2c, message=FALSE, echo=FALSE}
dfs = df %>% group_by(Organization.type) %>% summarise(Costs = 100*sum(Price)/sum(df$Price))
```

The Finnish data collection includes `r length(unique(df$Organization))` organizations ([see annual costs by organization](table/cost_by_organization_year.csv)). The universities (yliopisto) carry `r as.numeric(round(dfs[dfs$Organization.type == "University", "Costs"],1))`% of all costs (left figure); University of Helsinki has the highest total costs 2010-2015 (`r round(as.numeric((dfs = df %>% group_by(Organization) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs)))[1, "Costs"]),1)` MEUR; right figure).

```{r foi-totalcosts2d, message=FALSE, echo=FALSE, fig.show="hold", out.width="420px", fig.width = 10, fig.height = 9}
dfs = df %>% group_by(Organization.type) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(Costs)
dfs$Organization.type = factor(dfs$Organization.type, levels = as.character(dfs$Organization.type))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
p <- ggplot(dfs, aes(x = Organization.type, y = Costs)) + geom_bar(stat = "identity", fill = "lightgray", color = "black") + ggtitle("Costs by organization type") + coord_flip() + xlab("") + ylab("Total Costs (MEUR)") + geom_text(aes(x=Organization.type, y=80, label=paste(Percentage, "%", sep = ""), hjust=ifelse(sign(Percentage)>0, 0, 0)), position = position_dodge(width=1), size = 7)
print(p)

dfs = df %>% group_by(Organization) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(desc(Costs))
dfs$Organization = factor(dfs$Organization, levels = rev(as.character(dfs$Organization)))
dfs$Percentage = round(100 * dfs$Costs/sum(dfs$Costs), 1)
p <- ggplot(dfs[1:20,], aes(x = Organization, y = Costs)) + geom_bar(stat = "identity", fill = "lightgray", color = "black") + ggtitle("Costs by organization") + coord_flip() + xlab("") + ylab("Total Costs (MEUR)") + geom_text(aes(x=Organization, y=20, label=paste(Percentage, "%", sep = ""), hjust=ifelse(sign(Percentage)>0, 0, 0)), position = position_dodge(width=1), size = 7)
print(p)
```

As could be expected, the costs increase evenly across institutions. 

```{r foi-timebyorganization2, message=FALSE, echo=FALSE, fig.width=10, fig.heigth=2}
dfs = df %>% group_by(Organization) %>% summarise(Costs = sum(Price, na.rm = TRUE)) %>% arrange(desc(Costs))
top <- as.character(dfs$Organization[1:10])
dfs <- dplyr::filter(df, Organization %in% top) %>% group_by(Year, Organization) %>% summarise(Costs = sum(Price)/1e6) %>% arrange(Year)
dfs$Organization <- factor(dfs$Organization, levels = top)
p <- ggplot(dfs, aes(x = Year, y = Costs, color = Organization)) +
       geom_point() +
       geom_line() +       
       ggtitle("Cost development by organization") +
       ylab("Costs (MEUR)") 
print(p)
```


